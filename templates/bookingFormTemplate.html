<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Booking Form - {{bookingNumber}}</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin:89px 173px 113px 139px;
            line-height: 1.5;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        th, td {
            padding: 5px 8px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        .header-table {
            border: none;
        }
        .header-table td {
            border: none;
            padding: 2px 8px;
        }
        .item-table {
            font-size: 13px;
        }
        .item-table td {
            padding: 3px 5px;
        }
        .text-right {
            text-align: right;
        }
        .text-center {
            text-align: center;
        }
        .text-bold {
            font-weight: bold;
        }
        .section-title {
            font-weight: bold;
            margin: 15px 0 5px 0;
            border-bottom: 1px solid #000;
            padding-bottom: 3px;
        }
        .signature-table {
            margin-top: 50px;
        }
        .signature-table td {
            border: none;
            padding-top: 50px;
            width: 25%;
        }
        .declaration {
            font-size: 10px;
            text-align: justify;
            margin-top: 20px;
        }
        .notes-section {
            margin: 15px 0;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
        }
        .notes-label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        @media print {
            body {
                margin: 20mm;
                font-size: 12px;
                color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
            .no-print {
                display: none;
            }
            .qr-code-container {
                position: absolute;
                top: 15mm;
                right: 20mm;
            }
            .section-title {
                page-break-after: avoid;
            }
            table, tr, td, th {
                page-break-inside: avoid;
            }
            .notes-section {
                border: 1px solid #000;
                background-color: #fff;
            }
        }
    </style>
</head>
<body>
    <div class="qr-code-container">
        {{#if qrCode}}
        <img src="{{qrCode}}" width="80" height="80" alt="Booking QR Code">
        <div class="qr-code-text">Scan to change Booking Details</div>
        {{/if}}
    </div>

    <!-- Header Section -->
    <table class="header-table">
        <tr>
            <td width="40%"><font size="5"><b>Gandhi TVS</b></font></td>
            <td width="40%" class="text-center">
                <b><u>Booking Form / Order Form</u></b><br>
                {{#if (eq bookingType "SUBDEALER")}}
                <small>(Subdealer Booking)</small>
                {{/if}}
            </td>
            <td width="20%" class="text-right"><img src="dealership.gandhitvs.in/api/v1/images/logo.png" alt="tvs" width="150" height="80"></td>
        </tr>
        <tr>
            <td colspan="2">Authorized Main Dealer: TVS Motor Company Ltd.</td>
            <td class="text-right">Date: {{formatDate createdAt}}</td>
        </tr>
        <tr>
            <td colspan="3">
                {{#if (eq bookingType "SUBDEALER")}}
                Subdealer: {{subdealerDetails.name}} ({{subdealerDetails.location}})
                {{else}}
                {{branchDetails.name}}
                {{/if}}
            </td>
        </tr>
    </table>

    <!-- Vehicle Details Section -->
    {{#if chassisNumber}}
    <div class="vehicle-details-section">
        <h3>Vehicle Details</h3>
        <table>
            <tr>
                <td><strong>Chassis Number:</strong></td>
                <td>{{chassisNumber}}</td>
            </tr>
            <tr>
                <td><strong>Battery Number:</strong></td>
                <td>{{batteryNumber}}</td>
            </tr>
            <tr>
                <td><strong>Key Number:</strong></td>
                <td>{{keyNumber}}</td>
            </tr>
            {{#if motorNumber}}
            <tr>
                <td><strong>Motor Number:</strong></td>
                <td>{{motorNumber}}</td>
            </tr>
            {{/if}}
            {{#if chargerNumber}}
            <tr>
                <td><strong>Charger Number:</strong></td>
                <td>{{chargerNumber}}</td>
            </tr>
            {{/if}}
            {{#if engineNumber}}
            <tr>
                <td><strong>Engine Number:</strong></td>
                <td>{{engineNumber}}</td>
            </tr>
            {{/if}}
        </table>
    </div>
    {{/if}}

    <!-- Customer Details -->
    <div class="section-title">Customer & Vehicle Details</div>
    <table class="header-table">
        <tr>
            <td width="20%"><b>Booking No.:</b></td>
            <td width="30%">{{bookingNumber}}</td>
            <td width="20%"><b>GSTIN:</b></td>
            <td width="30%">{{#if gstin}}{{gstin}}{{else}}N/A{{/if}}</td>
        </tr>
        <tr>
            <td><b>Customer Name:</b></td>
            <td>{{customerDetails.salutation}} {{customerDetails.name}}</td>
            <td><b>RTO Type:</b></td>
            <td>{{rto}}</td>
        </tr>
        <tr>
            <td><b>Address:</b></td>
            <td colspan="3">{{customerDetails.address}}</td>
        </tr>
        <tr>
            <td><b>Taluka:</b></td>
            <td>{{customerDetails.taluka}}</td>
            <td><b>District:</b></td>
            <td>{{customerDetails.district}}</td>
        </tr>
        <tr>
            <td><b>Pincode:</b></td>
            <td>{{customerDetails.pincode}}</td>
            <td><b>Mobile No.:</b></td>
            <td>{{customerDetails.mobile1}}</td>
        </tr>
        <tr>
            <td><b>D.O.B.:</b></td>
            <td>{{formatDate customerDetails.dob}}</td>
            <td><b>Aadhar No.:</b></td>
            <td>{{#if customerDetails.aadharNumber}}{{customerDetails.aadharNumber}}{{else}}N/A{{/if}}</td>
        </tr>
        <tr>
            <td><b>Exchange Mode:</b></td>
            <td>{{#if exchange}}YES{{#if exchangeDetails.vehicleNumber}} ({{exchangeDetails.vehicleNumber}}){{/if}}{{else}}NO{{/if}}</td>
            <td><b>Payment Mode:</b></td>
            <td>{{payment.type}}{{#if (eq payment.type 'FINANCE')}} ({{payment.financer.name}}){{/if}}</td>
        </tr>
        <tr>
            <td><b>Model:</b></td>
            <td>{{modelDetails.model_name}}</td>
            <td><b>Color:</b></td>
            <td>{{colorDetails.name}}</td>
        </tr>
        <tr>
            <td><b>Sales Rep:</b></td>
            <td>
                {{#if (eq bookingType "SUBDEALER")}}
                {{subdealerUserDetails.name}} (Subdealer)
                {{else}}
                {{salesExecutiveDetails.name}}
                {{/if}}
            </td>
            <td><b>HPA:</b></td>
            <td>{{#if hpa}}YES{{else}}NO{{/if}}</td>
        </tr>
    </table>

    <!-- Notes Section - Added here -->
    {{#if note}}
    <div class="notes-section">
        <div class="notes-label">Special Notes:</div>
        <div>{{note}}</div>
    </div>
    {{/if}}

    <!-- Price Components -->
    <div class="section-title">Price Breakdown</div>
    <table class="item-table" border="0.5" frame="box">
        <thead>
            <tr>
                <th width="30%"><b>Particulars</b></th>
                <th><b>HSN</b></th>
                <th><b>Unit Cost</b></th>
                <th><b>Taxable</b></th>
                <th><b>CGST</b></th>
                <th><b>CGST AMOUNT</b></th>
                <th><b>SGST</b></th>
                <th><b>SGST AMOUNT</b></th>
                <th><b>DIS.</b></th>
                <th><b>LINE TOTAL</b></th>
            </tr>
        </thead>
        <tbody>
            {{#each priceComponents}}
            <tr>
                <td width="25%"><b>{{header.header_key}}</b></td>
                <td align="right">{{#if header.metadata.hsnCode}}{{header.metadata.hsnCode}}{{else}}{{#if header.metadata.hsn_code}}{{header.metadata.hsn_code}}{{else}}-{{/if}}{{/if}}</td>
                <td align="right">{{formatCurrency originalValue}}</td>
                <td align="right">{{formatCurrency discountedValue}}</td>
                <td align="right">{{#if header.metadata.gstRate}}{{divide header.metadata.gstRate 2}}{{else}}{{#if header.metadata.gst_rate}}{{divide header.metadata.gst_rate 2}}{{else}}0{{/if}}{{/if}}</td>
                <td align="right">{{#if header.metadata.gstRate}}{{formatCurrency (calculateTax discountedValue (divide header.metadata.gstRate 2))}}{{else}}{{#if header.metadata.gst_rate}}{{formatCurrency (calculateTax discountedValue (divide header.metadata.gst_rate 2))}}{{else}}0.00{{/if}}{{/if}}</td>
                <td align="right">{{#if header.metadata.gstRate}}{{divide header.metadata.gstRate 2}}{{else}}{{#if header.metadata.gst_rate}}{{divide header.metadata.gst_rate 2}}{{else}}0{{/if}}{{/if}}</td>
                <td align="right">{{#if header.metadata.gstRate}}{{formatCurrency (calculateTax discountedValue (divide header.metadata.gstRate 2))}}{{else}}{{#if header.metadata.gst_rate}}{{formatCurrency (calculateTax discountedValue (divide header.metadata.gst_rate 2))}}{{else}}0.00{{/if}}{{/if}}</td>
                <td align="right">{{formatCurrency (subtract originalValue discountedValue)}}</td>
                <td align="right">{{formatCurrency discountedValue}}</td>
            </tr>
            {{/each}}
            
            {{#each accessories}}
            <tr>
                <td width="25%"><b>{{#if accessory}}{{accessory.name}}{{else}}Additional Charges{{/if}}</b></td>
                <td align="right">{{#if accessory}}{{#if accessory.hsnCode}}{{accessory.hsnCode}}{{else}}-{{/if}}{{else}}-{{/if}}</td>
                <td align="right">{{formatCurrency price}}</td>
                <td align="right">{{formatCurrency (subtract price discount)}}</td>
                <td align="right">{{#if accessory}}{{#if accessory.gstRate}}{{divide accessory.gstRate 2}}{{else}}0{{/if}}{{else}}0{{/if}}</td>
                <td align="right">{{#if accessory}}{{#if accessory.gstRate}}{{formatCurrency (calculateTax (subtract price discount) (divide accessory.gstRate 2))}}{{else}}0.00{{/if}}{{else}}0.00{{/if}}</td>
                <td align="right">{{#if accessory}}{{#if accessory.gstRate}}{{divide accessory.gstRate 2}}{{else}}0{{/if}}{{else}}0{{/if}}</td>
                <td align="right">{{#if accessory}}{{#if accessory.gstRate}}{{formatCurrency (calculateTax (subtract price discount) (divide accessory.gstRate 2))}}{{else}}0.00{{/if}}{{else}}0.00{{/if}}</td>
                <td align="right">{{formatCurrency discount}}</td>
                <td align="right">{{formatCurrency (subtract price discount)}}</td>
            </tr>
            {{/each}}
        </tbody>
    </table>

    <!-- Totals Section -->
    <table class="header-table">
        <tr>
            <td colspan="3"><strong>Total(A)</strong></td>
            <td width="6%"><strong>{{formatCurrency totalAmount}}</strong></td>
        </tr>
    </table>

    <header class="clearfix"></header>
    <table>
        <tbody>
            {{#if (gt rtoAmount 0)}}
            <tr>
                <td width="80%"><b>RTO TAX,REGISTRATION SMART CARD CHARGES AGENT FEES</b></td>
                <td align="right">{{formatCurrency rtoAmount}}</td>
            </tr>
            {{/if}}
            
            {{#if (gt hypothecationCharges 0)}}
            <tr>
                <td width="80%"><b>HP CHARGES</b></td>
                <td align="right">{{formatCurrency hypothecationCharges}}</td>
            </tr>
            {{/if}}
            
            {{#if (gt accessoriesTotal 0)}}
            <tr>
                <td width="80%"><b>Insurance</b></td>
                <td align="right">{{formatCurrency accessoriesTotal}}</td>
            </tr>
            {{/if}}
        </tbody>
    </table>
    
    <header class="clearfix"></header>
    <table>
        <tr>
            <td colspan="3"><strong>Total(B)</strong></td>
            <td width="6%"><strong>{{formatCurrency (add rtoAmount hypothecationCharges accessoriesTotal)}}</strong></td>
        </tr>
    </table>
    
    <table>
        <tr>
            <td><strong>GRAND TOTAL(A) + (B)</strong></td>
            <td width="9%" align="right"><strong>{{formatCurrency (add totalAmount rtoAmount hypothecationCharges accessoriesTotal)}}</strong></td>
        </tr>
    </table>

    {{#if exchange}}
    <!-- Exchange Details -->
    <div class="section-title">Exchange Details</div>
    <table class="header-table">
        <tr>
            <td><strong>Ex. Broker/ Sub Dealer:-</strong></td>
            <td>{{exchangeDetails.broker.name}}</td>
            <td><strong>Ex. Veh No:-</strong></td>
            <td>{{exchangeDetails.vehicleNumber}}</td>
        </tr>
    </table>
    {{/if}}

    <!-- Notes -->
    <table>
        <tr>
            <td><strong>Notes:-</strong></td>
            <td colspan="3"></td>
        </tr>
    </table>

    <!-- Declaration -->
    <table>
        <tr>
            <td>
                {{#if accessories}}
                <strong>ACC.DETAILS:</strong>
                {{#each accessories}}
                {{#if accessory}}
                - {{accessory.name}}{{#unless @last}},{{/unless}}
                {{/if}}
                {{/each}}
                {{/if}}
            </td>
        </tr>
        <tr>
            <td class="declaration">
                <strong>Declaration-</strong> I/We Authorize the Dealer to register the vehicle at RTO in my/our name .2) Getting the vehicle insured from insurance company is my entire responsibility & there will be no liability on dealer for any loss. 3) Getting the vehicle registered from RTO is solely my responsibility & exclusively I/we shall/will be responsible for any loss/penalty/legal charge from RTO/Police for not getting the vehicle registered or for delayed registration. 4) Registration Number allotted by RTO will be acceptable to me else I will pre book for choice number at RTO at my own. Dealership has no role in RTO Number allocation 5) I had been informed & understood the T&C about warranty policy as laid by TVS MOTOR CO. LTD & I agree to abide the same 6) I/We agree that the price at the time of delivery will be applicable. 7) I am being informed about the price breakup, I had understood & agreed upon the same & then had booked the vehicle 9)I am bound to pay an interest @24% p.a. as penalty if payment is delayed for more than 5 days from the date of booking. 8) Subject to sangamner Jurisdication. I accept that vehicle once sold by dealer shall not be taken back /replaced for any reason.
            </td>
        </tr>
    </table>

    <!-- Signatures -->
    <table class="signature-table">
        <tr>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td>Customer's Signature</td>
            <td>
                {{#if (eq bookingType "SUBDEALER")}}
                Subdealer Representative
                {{else}}
                Sales Executive
                {{/if}}
            </td>
            <td>Manager</td>
            <td>Accountant</td>
        </tr>
    </table>
</body>
</html>